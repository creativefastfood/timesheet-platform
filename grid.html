<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–±–µ–ª—å - –ù–∞–±–æ—Ä–Ω–∞—è –ø–∞–Ω–µ–ª—å</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .timesheet-grid {
            border-collapse: collapse;
            width: 100%;
            font-size: 12px;
        }
        .timesheet-grid th, .timesheet-grid td {
            border: 1px solid #ddd;
            padding: 4px;
            text-align: center;
            vertical-align: middle;
        }
        .timesheet-grid th {
            background-color: #f8f9fa;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        .employee-name {
            background-color: #e9ecef;
            font-weight: bold;
            text-align: left;
            padding-left: 10px;
            width: 150px;
        }
        .role-cell {
            background-color: #f8f9fa;
            text-align: left;
            padding-left: 10px;
            width: 120px;
        }
        .rate-cell {
            background-color: #fff3cd;
            width: 80px;
        }
        .day-cell {
            width: 35px;
            height: 35px;
            position: relative;
        }
        .hour-input {
            width: 100%;
            height: 100%;
            border: none;
            background: transparent;
            text-align: center;
            font-size: 11px;
        }
        .hour-input:focus {
            background-color: #fff3cd;
            outline: 2px solid #0d6efd;
        }
        .total-cell {
            background-color: #d1ecf1;
            font-weight: bold;
            width: 100px;
        }
        .weekend {
            background-color: #ffe6e6;
        }
        .controls {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .summary {
            margin-top: 20px;
            padding: 15px;
            background-color: #d4edda;
            border-radius: 5px;
        }
        .month-nav {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container-fluid p-3">
        <h2><i class="bi bi-table"></i> –¢–∞–±–µ–ª—å —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ - –ù–∞–±–æ—Ä–Ω–∞—è –ø–∞–Ω–µ–ª—å</h2>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º -->
        <div class="month-nav">
            <button class="btn btn-outline-primary" onclick="changeMonth(-1)">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü</button>
            <h4 id="currentMonth">–ê–≤–≥—É—Å—Ç 2024</h4>
            <button class="btn btn-outline-primary" onclick="changeMonth(1)">–°–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü ‚Üí</button>
            <button class="btn btn-success ms-auto" onclick="saveAll()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë</button>
            <button class="btn btn-info" onclick="loadMonth()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü–∞ —Ç–∞–±–µ–ª—è -->
        <div class="table-responsive">
            <table class="timesheet-grid" id="timesheetGrid">
                <thead>
                    <tr>
                        <th rowspan="2">–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                        <th rowspan="2">–†–æ–ª—å</th>
                        <th rowspan="2">–°—Ç–∞–≤–∫–∞</th>
                        <th colspan="31" id="monthHeader">–ê–≤–≥—É—Å—Ç 2024</th>
                        <th rowspan="2">–í—Å–µ–≥–æ —á–∞—Å–æ–≤</th>
                        <th rowspan="2">–ö –Ω–∞—á–∏—Å–ª–µ–Ω–∏—é</th>
                    </tr>
                    <tr id="dayHeaders">
                        <!-- –î–Ω–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </tr>
                </thead>
                <tbody id="gridBody">
                    <!-- –°—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </tbody>
            </table>
        </div>

        <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ -->
        <div class="summary">
            <div class="row">
                <div class="col-md-3">
                    <strong>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤:</strong>
                    <span id="totalHours">0</span>
                </div>
                <div class="col-md-3">
                    <strong>–û–±—â–∞—è —Å—É–º–º–∞ –∫ –≤—ã–ø–ª–∞—Ç–µ:</strong>
                    <span id="totalAmount">0 ‚ÇΩ</span>
                </div>
                <div class="col-md-3">
                    <strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π:</strong>
                    <span id="workingDays">0</span>
                </div>
                <div class="col-md-3">
                    <strong>–°—Ä–µ–¥–Ω–µ–¥–Ω–µ–≤–Ω–∞—è —Å—É–º–º–∞:</strong>
                    <span id="avgDaily">0 ‚ÇΩ</span>
                </div>
            </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ -->
        <div class="mt-4">
            <h4>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∞–º–∏</h4>
            <div class="row g-2">
                <div class="col-md-3">
                    <select class="form-select" id="employeeSelect">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="roleSelect">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <button class="btn btn-success w-100" onclick="addRow()">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
                </div>
                <div class="col-md-2">
                    <button class="btn btn-warning w-100" onclick="fillWorkingDays()">üìÖ –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏</button>
                </div>
                <div class="col-md-2">
                    <button class="btn btn-secondary w-100" onclick="clearAll()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
                </div>
            </div>
            <div class="mt-2">
                <small class="text-muted">
                    –°–æ–≤–µ—Ç: –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏ –∫–ª–∏–∫–∞–π—Ç–µ –ø–æ —è—á–µ–π–∫–∞–º –¥–Ω–µ–π –∏ –≤–≤–æ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 8, 4.5, 9)
                </small>
            </div>
        </div>

        <div class="mt-3">
            <a href="frontend/index.html" class="btn btn-outline-primary">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É</a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentDate = new Date(2024, 7, 1); // –ê–≤–≥—É—Å—Ç 2024
        let employees = [];
        let roles = [];
        let gridData = {};

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadEmployeesAndRoles();
            generateGrid();
            loadTestData(); // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
        async function loadEmployeesAndRoles() {
            // –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
            employees = [
                {id: 1, name: '–Ø–Ω–∞'},
                {id: 2, name: '–ò–ª—å—è –ü–æ–ª—É–º—è–≥–∫–∏–π'},
                {id: 3, name: '–ö–æ–≤–∞—á –ê–Ω–¥—Ä–∏–∞–Ω–∞ –ò–≤–∞–Ω–æ–≤–Ω–∞'},
                {id: 4, name: '–ö—É–∑—å–º–∏–Ω–∞ –ö—Ä–∏—Å—Ç–∏–Ω–∞'},
                {id: 5, name: '–°–æ–∫–æ–ª–æ–≤ –°–∞–≤–µ–ª–∏–π –ê–ª–µ–∫—Å–µ–µ–≤–∏—á'}
            ];

            roles = [
                {id: 1, name: '–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç', rate: 312.50},
                {id: 2, name: '–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç, –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏', rate: 350.00},
                {id: 3, name: '–í—ã–µ–∑–¥–Ω–∞—è', rate: 500.00},
                {id: 4, name: '–ú–æ–¥–µ–ª—å', rate: 500.00},
                {id: 5, name: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', rate: 375.00}
            ];

            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–µ–ª–µ–∫—Ç—ã
            const employeeSelect = document.getElementById('employeeSelect');
            const roleSelect = document.getElementById('roleSelect');

            employees.forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = emp.name;
                employeeSelect.appendChild(option);
            });

            roles.forEach(role => {
                const option = document.createElement('option');
                option.value = role.id;
                option.textContent = `${role.name} (${role.rate}‚ÇΩ/—á)`;
                roleSelect.appendChild(option);
            });
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ç–∫–∏
        function generateGrid() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º–µ—Å—è—Ü–∞
            const monthNames = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                              '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];
            document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;
            document.getElementById('monthHeader').textContent = `${monthNames[month]} ${year}`;
            document.getElementById('monthHeader').setAttribute('colspan', daysInMonth);

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π
            const dayHeaders = document.getElementById('dayHeaders');
            dayHeaders.innerHTML = '';
            
            for (let day = 1; day <= daysInMonth; day++) {
                const th = document.createElement('th');
                th.textContent = day;
                th.className = 'day-header';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã—Ö–æ–¥–Ω—ã–µ
                const date = new Date(year, month, day);
                if (date.getDay() === 0 || date.getDay() === 6) {
                    th.classList.add('weekend');
                }
                
                dayHeaders.appendChild(th);
            }

            // –û—á–∏—â–∞–µ–º —Ç–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã
            document.getElementById('gridBody').innerHTML = '';
            gridData = {};
            updateTotals();
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
        function addRow() {
            const employeeId = document.getElementById('employeeSelect').value;
            const roleId = document.getElementById('roleSelect').value;

            if (!employeeId || !roleId) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏ —Ä–æ–ª—å');
                return;
            }

            const employee = employees.find(e => e.id == employeeId);
            const role = roles.find(r => r.id == roleId);
            const rowId = `${employeeId}_${roleId}`;

            if (gridData[rowId]) {
                alert('–¢–∞–∫–∞—è —Å—Ç—Ä–æ–∫–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }

            // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É –¥–∞–Ω–Ω—ã—Ö
            gridData[rowId] = {
                employeeId: employeeId,
                employeeName: employee.name,
                roleId: roleId,
                roleName: role.name,
                rate: role.rate,
                days: {}
            };

            renderRows();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å—Ç—Ä–æ–∫
        function renderRows() {
            const tbody = document.getElementById('gridBody');
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            tbody.innerHTML = '';

            Object.keys(gridData).forEach(rowId => {
                const data = gridData[rowId];
                const tr = document.createElement('tr');

                // –Ø—á–µ–π–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                const employeeCell = document.createElement('td');
                employeeCell.className = 'employee-name';
                employeeCell.textContent = data.employeeName;
                tr.appendChild(employeeCell);

                // –Ø—á–µ–π–∫–∞ —Ä–æ–ª–∏
                const roleCell = document.createElement('td');
                roleCell.className = 'role-cell';
                roleCell.textContent = data.roleName;
                tr.appendChild(roleCell);

                // –Ø—á–µ–π–∫–∞ —Å—Ç–∞–≤–∫–∏
                const rateCell = document.createElement('td');
                rateCell.className = 'rate-cell';
                rateCell.textContent = data.rate + '‚ÇΩ';
                tr.appendChild(rateCell);

                // –Ø—á–µ–π–∫–∏ –¥–Ω–µ–π
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayCell = document.createElement('td');
                    dayCell.className = 'day-cell';
                    
                    const date = new Date(year, month, day);
                    if (date.getDay() === 0 || date.getDay() === 6) {
                        dayCell.classList.add('weekend');
                    }

                    const input = document.createElement('input');
                    input.type = 'number';
                    input.step = '0.5';
                    input.min = '0';
                    input.max = '24';
                    input.className = 'hour-input';
                    input.value = data.days[day] || '';
                    input.addEventListener('input', function() {
                        updateDayValue(rowId, day, this.value);
                    });

                    dayCell.appendChild(input);
                    tr.appendChild(dayCell);
                }

                // –Ø—á–µ–π–∫–∞ –æ–±—â–∏—Ö —á–∞—Å–æ–≤
                const totalHoursCell = document.createElement('td');
                totalHoursCell.className = 'total-cell';
                totalHoursCell.id = `total_hours_${rowId}`;
                tr.appendChild(totalHoursCell);

                // –Ø—á–µ–π–∫–∞ —Å—É–º–º—ã
                const totalAmountCell = document.createElement('td');
                totalAmountCell.className = 'total-cell';
                totalAmountCell.id = `total_amount_${rowId}`;
                tr.appendChild(totalAmountCell);

                tbody.appendChild(tr);
            });

            updateTotals();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–Ω—è
        function updateDayValue(rowId, day, value) {
            if (!gridData[rowId]) return;

            if (value && value > 0) {
                gridData[rowId].days[day] = parseFloat(value);
            } else {
                delete gridData[rowId].days[day];
            }

            updateTotals();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤
        function updateTotals() {
            let grandTotalHours = 0;
            let grandTotalAmount = 0;
            let workingDaysCount = 0;

            Object.keys(gridData).forEach(rowId => {
                const data = gridData[rowId];
                let rowHours = 0;
                let rowAmount = 0;

                Object.values(data.days).forEach(hours => {
                    rowHours += hours;
                    rowAmount += hours * data.rate;
                });

                grandTotalHours += rowHours;
                grandTotalAmount += rowAmount;

                if (Object.keys(data.days).length > 0) {
                    workingDaysCount = Math.max(workingDaysCount, Object.keys(data.days).length);
                }

                // –û–±–Ω–æ–≤–ª—è–µ–º —è—á–µ–π–∫–∏ –∏—Ç–æ–≥–æ–≤ –ø–æ —Å—Ç—Ä–æ–∫–µ
                const hoursCell = document.getElementById(`total_hours_${rowId}`);
                const amountCell = document.getElementById(`total_amount_${rowId}`);
                
                if (hoursCell) hoursCell.textContent = rowHours.toFixed(1);
                if (amountCell) amountCell.textContent = Math.round(rowAmount) + '‚ÇΩ';
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â–∏–µ –∏—Ç–æ–≥–∏
            document.getElementById('totalHours').textContent = grandTotalHours.toFixed(1);
            document.getElementById('totalAmount').textContent = Math.round(grandTotalAmount) + '‚ÇΩ';
            document.getElementById('workingDays').textContent = workingDaysCount;
            document.getElementById('avgDaily').textContent = workingDaysCount > 0 ? 
                Math.round(grandTotalAmount / workingDaysCount) + '‚ÇΩ' : '0‚ÇΩ';
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        function loadTestData() {
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
            const testRows = [
                {empId: 1, roleId: 1}, // –Ø–Ω–∞ - –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                {empId: 1, roleId: 5}, // –Ø–Ω–∞ - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
                {empId: 2, roleId: 1}, // –ò–ª—å—è - –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                {empId: 2, roleId: 2}, // –ò–ª—å—è - –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏
                {empId: 2, roleId: 3}, // –ò–ª—å—è - –í—ã–µ–∑–¥–Ω–∞—è
                {empId: 2, roleId: 5}, // –ò–ª—å—è - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
                {empId: 3, roleId: 1}, // –ö–æ–≤–∞—á - –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                {empId: 3, roleId: 2}, // –ö–æ–≤–∞—á - –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏
                {empId: 3, roleId: 3}, // –ö–æ–≤–∞—á - –í—ã–µ–∑–¥–Ω–∞—è
                {empId: 3, roleId: 4}, // –ö–æ–≤–∞—á - –ú–æ–¥–µ–ª—å
                {empId: 4, roleId: 1}, // –ö—É–∑—å–º–∏–Ω–∞ - –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                {empId: 4, roleId: 2}, // –ö—É–∑—å–º–∏–Ω–∞ - –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏
                {empId: 5, roleId: 1}, // –°–æ–∫–æ–ª–æ–≤ - –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                {empId: 5, roleId: 2}, // –°–æ–∫–æ–ª–æ–≤ - –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏
                {empId: 5, roleId: 5}  // –°–æ–∫–æ–ª–æ–≤ - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
            ];

            testRows.forEach(row => {
                const employee = employees.find(e => e.id == row.empId);
                const role = roles.find(r => r.id == row.roleId);
                const rowId = `${row.empId}_${row.roleId}`;

                gridData[rowId] = {
                    employeeId: row.empId,
                    employeeName: employee.name,
                    roleId: row.roleId,
                    roleName: role.name,
                    rate: role.rate,
                    days: {}
                };
            });

            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —á–∞—Å—ã (–ø—Ä–∏–º–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞)
            const testHours = {
                '1_1': {8: 8, 15: 4}, // –Ø–Ω–∞-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                '1_5': {11: 9, 12: 9, 13: 9, 14: 9, 15: 9, 19: 9, 20: 9, 21: 9, 22: 9}, // –Ø–Ω–∞-–ê–¥–º–∏–Ω
                '2_1': {15: 7, 19: 8, 20: 8}, // –ò–ª—å—è-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                '2_2': {12: 5, 18: 6, 19: 9, 21: 3, 22: 1}, // –ò–ª—å—è-–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏
                '2_3': {11: 9}, // –ò–ª—å—è-–í—ã–µ–∑–¥–Ω–∞—è
                '2_5': {9: 4, 20: 2}, // –ò–ª—å—è-–ê–¥–º–∏–Ω
                '3_1': {15: 7}, // –ö–æ–≤–∞—á-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                '3_2': {11: 8, 12: 8, 13: 8, 14: 8}, // –ö–æ–≤–∞—á-–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏
                '3_3': {9: 9, 20: 9, 21: 8, 22: 7}, // –ö–æ–≤–∞—á-–í—ã–µ–∑–¥–Ω–∞—è
                '3_4': {16: 32}, // –ö–æ–≤–∞—á-–ú–æ–¥–µ–ª—å
                '4_1': {11: 8, 18: 2}, // –ö—É–∑—å–º–∏–Ω–∞-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                '4_2': {11: 3}, // –ö—É–∑—å–º–∏–Ω–∞-–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏
                '5_1': {16: 4, 17: 3}, // –°–æ–∫–æ–ª–æ–≤-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç
                '5_2': {11: 4, 12: 5, 13: 5, 16: 2, 17: 2}, // –°–æ–∫–æ–ª–æ–≤-–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏
                '5_5': {10: 3, 11: 7, 12: 3, 13: 3, 20: 2, 21: 7} // –°–æ–∫–æ–ª–æ–≤-–ê–¥–º–∏–Ω
            };

            Object.keys(testHours).forEach(rowId => {
                if (gridData[rowId]) {
                    gridData[rowId].days = testHours[rowId];
                }
            });

            renderRows();
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º
        function changeMonth(delta) {
            currentDate.setMonth(currentDate.getMonth() + delta);
            generateGrid();
        }

        // –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏
        function fillWorkingDays() {
            const hours = prompt('–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ –¥–ª—è —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π:');
            if (!hours) return;

            const hoursNum = parseFloat(hours);
            if (isNaN(hoursNum) || hoursNum <= 0) return;

            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            Object.keys(gridData).forEach(rowId => {
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(year, month, day);
                    // –¢–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ (–ø–Ω-–ø—Ç)
                    if (date.getDay() !== 0 && date.getDay() !== 6) {
                        gridData[rowId].days[day] = hoursNum;
                    }
                }
            });

            renderRows();
        }

        // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë
        function clearAll() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ?')) {
                gridData = {};
                renderRows();
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞)
        function saveAll() {
            console.log('–°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ:', gridData);
            alert('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã! (–ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ –≤ –ø–∞–º—è—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞)');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ—Å—è—Ü–∞
        function loadMonth() {
            loadTestData();
            alert('–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
        }
    </script>
</body>
</html>