-- Загрузка тестовых данных из скриншота

USE timesheet_platform;

-- Добавляем сотрудников из таблицы
INSERT INTO employees (full_name, email, phone) VALUES
('Яна', 'yana@company.ru', '+7-900-123-4567'),
('Илья Полумягкий', 'ilya.polumyagkiy@company.ru', '+7-900-234-5678'),
('Ковач Андриана Ивановна', 'kovach.andriana@company.ru', '+7-900-345-6789'),
('Кузьмина Кристина', 'kuzmina.kristina@company.ru', '+7-900-456-7890'),
('Соколов Савелий Алексеевич', 'sokolov.saveliy@company.ru', '+7-900-567-8901');

-- Обновляем роли согласно скриншоту
UPDATE roles SET hourly_rate = 312.50 WHERE role_name = 'Ассистент';
UPDATE roles SET hourly_rate = 350.00 WHERE role_name = 'Ассистент, переработки';
UPDATE roles SET hourly_rate = 500.00 WHERE role_name = 'Выездная';
UPDATE roles SET hourly_rate = 500.00 WHERE role_name = 'Модель';
UPDATE roles SET hourly_rate = 375.00 WHERE role_name = 'Администратор';

-- Добавляем рабочие смены из скриншота

-- Яна
INSERT INTO work_shifts (employee_id, role_id, work_date, hours_worked, notes) VALUES
(1, 1, '2024-08-08', 8, 'Обычная смена'),
(1, 1, '2024-08-15', 4, 'Сокращенный день'),
(1, 5, '2024-08-11', 9, 'Административные задачи'),
(1, 5, '2024-08-12', 9, 'Административные задачи'),
(1, 5, '2024-08-13', 9, 'Административные задачи'),
(1, 5, '2024-08-14', 9, 'Административные задачи'),
(1, 5, '2024-08-15', 9, 'Административные задачи'),
(1, 5, '2024-08-19', 9, 'Административные задачи'),
(1, 5, '2024-08-20', 9, 'Административные задачи'),
(1, 5, '2024-08-21', 9, 'Административные задачи'),
(1, 5, '2024-08-22', 9, 'Административные задачи');

-- Илья Полумягкий
INSERT INTO work_shifts (employee_id, role_id, work_date, hours_worked, notes) VALUES
(2, 1, '2024-08-15', 7, 'Основная работа'),
(2, 1, '2024-08-19', 8, 'Полный день'),
(2, 1, '2024-08-20', 8, 'Полный день'),
(2, 2, '2024-08-12', 5, 'Переработка'),
(2, 2, '2024-08-18', 6, 'Переработка'),
(2, 2, '2024-08-19', 9, 'Переработка'),
(2, 2, '2024-08-21', 3, 'Переработка'),
(2, 2, '2024-08-22', 1, 'Переработка'),
(2, 3, '2024-08-11', 9, 'Выездная съемка'),
(2, 5, '2024-08-09', 4, 'Админ работа'),
(2, 5, '2024-08-20', 2, 'Админ работа');

-- Ковач Андриана Ивановна
INSERT INTO work_shifts (employee_id, role_id, work_date, hours_worked, notes) VALUES
(3, 1, '2024-08-15', 7, 'Основная работа'),
(3, 2, '2024-08-11', 8, 'Переработка'),
(3, 2, '2024-08-12', 8, 'Переработка'),
(3, 2, '2024-08-13', 8, 'Переработка'),
(3, 2, '2024-08-14', 8, 'Переработка'),
(3, 3, '2024-08-09', 9, 'Выездная съемка'),
(3, 3, '2024-08-20', 9, 'Выездная съемка'),
(3, 3, '2024-08-21', 8, 'Выездная съемка'),
(3, 3, '2024-08-22', 7, 'Выездная съемка'),
(3, 4, '2024-08-09', 32, 'Работа моделью'); -- 32 часа за период как в таблице

-- Кузьмина Кристина  
INSERT INTO work_shifts (employee_id, role_id, work_date, hours_worked, notes) VALUES
(4, 1, '2024-08-11', 8, 'Основная работа'),
(4, 1, '2024-08-18', 2, 'Сокращенный день'),
(4, 2, '2024-08-11', 3, 'Переработка');

-- Соколов Савелий Алексеевич
INSERT INTO work_shifts (employee_id, role_id, work_date, hours_worked, notes) VALUES
(5, 1, '2024-08-16', 4, 'Основная работа'),
(5, 1, '2024-08-17', 3, 'Сокращенный день'),
(5, 2, '2024-08-11', 4, 'Переработка'),
(5, 2, '2024-08-12', 5, 'Переработка'),
(5, 2, '2024-08-13', 5, 'Переработка'),
(5, 2, '2024-08-16', 2, 'Переработка'),
(5, 2, '2024-08-17', 2, 'Переработка'),
(5, 5, '2024-08-10', 3, 'Административные задачи'),
(5, 5, '2024-08-11', 7, 'Административные задачи'),
(5, 5, '2024-08-12', 3, 'Административные задачи'),
(5, 5, '2024-08-13', 3, 'Административные задачи'),
(5, 5, '2024-08-20', 2, 'Административные задачи'),
(5, 5, '2024-08-21', 7, 'Административные задачи');

-- Создаем тестовых пользователей для демонстрации
INSERT INTO users (username, password_hash, user_role, employee_id) VALUES
('admin', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'admin', NULL),
('manager', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'manager', NULL),
('yana', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 'employee', 1);

-- Добавляем больше данных за разные месяцы для демонстрации
INSERT INTO work_shifts (employee_id, role_id, work_date, hours_worked, notes) VALUES
-- Июль 2024
(1, 1, '2024-07-15', 8, 'Летняя работа'),
(1, 5, '2024-07-16', 6, 'Админ задачи'),
(2, 2, '2024-07-20', 5, 'Переработка в июле'),
(3, 3, '2024-07-22', 9, 'Выездная в июле'),

-- Сентябрь 2024  
(1, 1, '2024-09-05', 8, 'Начало сентября'),
(2, 5, '2024-09-10', 4, 'Админ работа'),
(4, 1, '2024-09-15', 7, 'Обычный день'),
(5, 2, '2024-09-20', 3, 'Переработка');

-- Показать итоговую статистику
SELECT 'Статистика загруженных данных:' as info;

SELECT 
    'Всего сотрудников:' as metric,
    COUNT(*) as value
FROM employees

UNION ALL

SELECT 
    'Всего смен:' as metric,
    COUNT(*) as value
FROM work_shifts

UNION ALL

SELECT 
    'Общая сумма (август 2024):' as metric,
    CONCAT(ROUND(SUM(w.hours_worked * r.hourly_rate)), ' ₽') as value
FROM work_shifts w
JOIN roles r ON w.role_id = r.id
WHERE w.work_date BETWEEN '2024-08-01' AND '2024-08-31';